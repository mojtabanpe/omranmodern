<div class="section p-0">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a routerLink="/modern/dashboard">عمران مدرن</a></li>
      <li class="breadcrumb-item"><a routerLink="/modern/manage_materials">کالاها</a></li>
      <li class="breadcrumb-item active" aria-current="page">معرفی کالای جدید</li>
    </ol>
  </nav>
</div>

<div class="section-warning mb-5">
  <h4>وضعیت کالا را مشخص کنید</h4>
    <select [(ngModel)]="selectedStatus" class="form-control">
      <option value={{option.value}} *ngFor="let option of statuses">{{ option.viewValue }}</option>
    </select>
</div>

<div class="section">
  <div *ngIf="initializedCategoryDropdown">
    <h4>تعریف گروه والد کالا</h4>
    <ng-multiselect-dropdown #categorySelect
      [placeholder]="'عنوان خوشه را انتخاب کنید'"
      [settings]="categoryDropdownSettings"
      (onSelect)="onItemSelect($event)"
      [data]="categories"
      [(ngModel)]="selectedCategory">
    </ng-multiselect-dropdown>
  </div>

  <div class="row five-box">
    <div class="col-6 pr-0">
      <h4>عنوان کالا</h4>
      <input class="form-control" [(ngModel)]="materialName">
    </div>

    <div class="col-6 pl-0">
      <div>
        <h4>کالای مادر</h4>
        <ng-multiselect-dropdown #materialSelect
          [placeholder]="'در صورت نیاز انتخاب کنید'"
          [settings]="materialDropdownSettings"
          [data]="materials"
          [(ngModel)]="selectedMaterial">
        </ng-multiselect-dropdown>
      </div>
    </div>

    <div class="col-6 pr-0" *ngIf="isChild()">
      <div *ngIf="initializedBrandDropdown">
        <h4>برند کالا</h4>
        <ng-multiselect-dropdown #brandSelect
          [placeholder]="'برند مورد نظر را جستجو کنید'"
          [settings]="brandDropdownSettings"
          [data]="brands"
          [(ngModel)]="selectedBrand">
        </ng-multiselect-dropdown>
        <button class="btn btn-light d-flex align-items-center btn-sm mr-auto mt-2 text-secondary">
          <mat-icon>add</mat-icon>
          <a class="text-secondary" (click)="addBrand()">افزودن برند جدید</a>
        </button>
      </div>
    </div>

    <div class="col-6 pl-0" *ngIf="isChild()">
      <h4>کیفیت کالا</h4>
      <select [(ngModel)]="quality" class="form-control">
        <option *ngFor="let q of qualities" value={{q}}>{{q}}</option>
      </select>
    </div>

  </div>

  <div>
    <input [disabled]="inProgress" #fileInput type="file" class="file-input" (change)="onFileChanged($event)">
    <div (click)="fileInput.click()" class="mt-3 mb-2 d-flex align-items-center cursor-pointer">
      <mat-icon> attach_file</mat-icon>
      <span>افزودن عکس کالا(حداقل یک عکس)</span>
    </div>
    <div *ngFor="let section of sections; index as i" class="section row d-flex align-items-center">
      <div class="col-1"><mat-icon (click)="removePicture(i)">cancel</mat-icon></div>
      <div class="col-9 d-flex flex-column">
        <span class="ml-auto mb-1">{{section.progressPercent}}%</span>
        <mat-progress-bar class="" [value]="section.progressPercent"></mat-progress-bar>
      </div> 
      <div class="col-2" *ngIf="section.finished">
        <img src={{section.src}} class="w-100">         
      </div>
    </div>
  </div>
  <hr>

  <div *ngIf="selectedCategory" class="section mt-5">
    <div  *ngIf="!isChild()">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h4>نمایش در فیلتر کالای مادر</h4>
        <button class="btn btn-outline-info btn-sm mr-auto">افزودن ویژگی به فروشنده</button>
      </div>
      <div class="d-flex align-items-center flex-wrap">
        <div *ngFor="let attr of attributes" class="section-gray mx-2">
          <mat-slide-toggle [checked]="attr.show_in_filter" (change)="attr.show_in_filter = !attr.show_in_filter"><span class="mr-1">{{attr.name}}</span></mat-slide-toggle>
        </div>
      </div>
    </div>
    <div *ngIf="isChild()">
      <h4 class="mb-5">انتخاب ویژگی</h4>
      <div class="d-flex align-items-center my-3" *ngFor="let attr of attributes">
        <label class="ml-3">{{attr.name}}</label>
        <select class="form-control" (change)=changeAttributeValue(attr,$event.target.value)>
          <option disabled selected>لطفا انتخاب کنید</option>
          <option *ngFor="let item of attr.possible_values" [value]="item">{{item}}</option>
        </select>
      </div>
    </div>
  </div>

  <div class="my-5">
    <h3>معرفی کالا</h3>
    <ckeditor [(ngModel)]="materialExplain" [editor]="Editor"></ckeditor>
  </div>
  <mat-checkbox *ngIf="isChild()" [(ngModel)]="material.is_suggested">پیشنهاد عمران مدرن</mat-checkbox>
  <div class="d-flex pt-5">
    <button class="btn btn-info w-50 mx-auto" (click)="submit()">ذخیره اطلاعات</button>
  </div>
</div>